import{e as l,b as i}from"./web-app-DnuSsBjl.js";async function y(r){const t=l.map(async n=>{const e=`eurosaver:article:${r}:${n.id}`;return(await i.storage.local.get([e]))[e]});return Promise.all(t).then(n=>n.filter(e=>e!==void 0))}async function w(r){const t=`eurosaver:article:${r.asin}:${r.country.id}`;await i.storage.local.set({[t]:r})}function u(r){return new Proxy({},{get(t,n){return e=>new Promise((o,a)=>{r({type:n,data:e},s=>{if(!s){a(new Error("Failed to resolve response, got undefined"));return}if(s.isError){a(s.error);return}o(s.data)})})}})}function d(r){return r instanceof Error?r:typeof r=="string"?new Error(r):typeof r=="object"&&r!==null?new Error(JSON.stringify(r)):new Error("Unknown error")}function E(r,t){if(typeof r=="function"){const e=r;return()=>Promise.resolve(e())}if(!t)throw new Error("Callback is required");const n=r;return e=>{const o=n.parse(e);return Promise.resolve(t(o))}}function m(r,t){return r(async(n,e)=>{const{type:o,data:a}=n,s=t[o];if(!s){e({isError:!0,error:new Error(`Handler for type "${String(o)}" not found`)});return}try{e({isError:!1,data:await s(a)})}catch(c){const f=d(c);e({isError:!0,error:f})}}),{...t}}function v(r){return u((t,n)=>{i.tabs.sendMessage(r,t).then(n)})}function p(){return u((r,t)=>{i.runtime.sendMessage(r).then(t)})}export{m as a,v as b,p as c,E as h,y as l,w as s};
